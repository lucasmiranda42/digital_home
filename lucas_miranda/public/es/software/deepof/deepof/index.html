<!DOCTYPE html>
<html lang="es" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>DeepOF | Inicio</title>
<meta name="keywords" content="Software, DeepOF, DeepLabCut, SLEAP, Roedores, Series temporales, Postprocesado, Videos, Python, Jupyter, Machine Learning, Deep Learning, Comportamiento animal">
<meta name="description" content="DeepOF es una herramienta de postprocesado para series temporales de datos de comportamiento animal, obtenidas a través de DeepLabCut o SLEAP.">
<meta name="author" content="Lucas Miranda">
<link rel="canonical" href="//localhost:1313/es/software/deepof/deepof/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.2d50b1531bd1b3146d65c5543bd298f7f982786aadee4c223cb3a1cb51906106.css" integrity="sha256-LVCxUxvRsxRtZcVUO9KY9/mCeGqt7kwiPLOhy1GQYQY=" rel="preload stylesheet" as="style">
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/en/software/deepof/deepof/">
<link rel="alternate" hreflang="es" href="//localhost:1313/es/software/deepof/deepof/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="DeepOF" />
<meta property="og:description" content="DeepOF es una herramienta de postprocesado para series temporales de datos de comportamiento animal, obtenidas a través de DeepLabCut o SLEAP." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/es/software/deepof/deepof/" />
<meta property="og:image" content="//localhost:1313/deepof_cover.png" /><meta property="article:section" content="software" />





<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="//localhost:1313/deepof_cover.png" />
<meta name="twitter:title" content="DeepOF"/>
<meta name="twitter:description" content="DeepOF es una herramienta de postprocesado para series temporales de datos de comportamiento animal, obtenidas a través de DeepLabCut o SLEAP."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Software",
      "item": "//localhost:1313/es/software/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "DeepOF",
      "item": "//localhost:1313/es/software/deepof/deepof/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DeepOF",
  "name": "DeepOF",
  "description": "DeepOF es una herramienta de postprocesado para series temporales de datos de comportamiento animal, obtenidas a través de DeepLabCut o SLEAP.",
  "keywords": [
    "Software", "DeepOF", "DeepLabCut", "SLEAP", "Roedores", "Series temporales", "Postprocesado", "Videos", "Python", "Jupyter", "Machine Learning", "Deep Learning", "Comportamiento animal"
  ],
  "articleBody": "DeepOF es un paquete de Python para procesar datos de trackeo de animales, obtenidos con DeepLabCut o SLEAP. Las herramientas que tenemos disponibles para cuantificar lo que hacen los animales evolucionaron significativamente en la última década. Desde la observación de animales en la naturaleza, la etología se desplazó significativamente hacia pruebas más simples y controladas en el laboratorio, generalmente midiendo respuestas sencillas a ciertos estímulos.\nAvances recientes en visión por computadora y aprendizaje automático permitieron a los investigadores rastrear en detalle el movimiento de animales tanto en el laboratorio como en la naturaleza, sin la necesidad de etiquetas físicas. Típicamente, estos programas se basan en transfer learning (aprendizaje por transferencia) a partir de redes neuronales preentrenadas en grandes conjuntos de datos de imágenes, que primero extraen representaciones de los fotogramas de video. Al etiquetar relativamente pocos fotogramas con partes del cuerpo de interés (unos 200 suelen bastar), las redes pueden luego ajustarse para rastrear estas partes del cuerpo en todos los videos a disposición. Abajo podés ver el flujo de trabajo general del artículo original de DeepLabCut. Modelos más modernos pueden rastrear partes del cuerpo de interés incluso sin etiquetado previo, aunque siguen siendo menos precisas que estos métodos supervisados.\nDe esta forma, transformando el video crudo en series temporales de partes del cuerpo rastreadas, estos programas (incluyendo los mencionados DeepLabCut y SLEAP) allanaron el camino para herramientas de análisis que pueden etiquetar y caracterizar automáticamente el comportamiento de muchas maneras innovadoras.\nDeepOF es nuestra humilde contribución a este esfuerzo. El programa ofrece tanto funciones de anotación tanto supervisada como no supervisada, que permiten a los investigadores probar hipótesis sobre condiciones experimentales como el estrés, mutaciones genéticas y sexo, de una manera flexible.\nEn primer lugar, la anotación supervisada incluido usa una serie de reglas y modelos de aprendizaje automático preentrenados para detectar cuándo los animales que se están rastreando muestran alguno de una serie de patrones de comportamiento predefinidos.\nDe esta manera, podemos etiquetar tanto comportamientos individuales como sociales con solo unas pocas líneas de código! Veamos un ejemplo básico:\nimport deepof.data my_deepof_project_raw = deepof.data.Project( project_path=os.path.join(\"tutorial_files\"), video_path=os.path.join(\"tutorial_files/Videos/\"), table_path=os.path.join(\"tutorial_files/Tables/\"), project_name=\"deepof_example_project\", ) supervised_annotation = my_deepof_project.supervised_annotation() Así de fácil, anotamos todos nuestros videos con un conjunto de modelos preentrenados que pueden detectar comportamientos tales como encogerse, trepar, y distintas interacciones sociales.\nAdemás, como mencionamos arriba, DeepOF también viene con un flujo de trabajo no supervisado, que modelos modelos de agrupamiento profundo para descubrir patrones de comportamiento sin definición previa, que también se puede ejecutar con unos pocos comandos:\n# Continuando desde arriba, creamos un conjunto de coordenadas para agrupar, # removiendo variación posicional y rotacional que no nos interesa coords = my_deepof_project.get_coords(center=\"Center\", align=\"Spine_1\") # Luego preprocesamos estas coordenadas para hacerlas compatibles con el clustering preprocessed_coords, global_scaler = coords.preprocess() # Finalmente, entrenamos un modelo de clustering con estas coordenadas preprocesadas trained_model = my_deepof_project.deep_unsupervised_embedding( preprocessed_object=preprocessed_coords ) Por último, DeepOF incluye un pipeline de interpretabilidad para explorar qué son estos clusters obtenidos, basándonos tanto en Shapley Additive Explanations (SHAP) como en mapeos directos de clusters a fragmentos de video. Además, independientemente del tipo de análisis que elijas, DeepOF te ofrece un extenso conjunto de herramientas de análisis y visualización post-hoc. A continuación podés ver los resultados de SHAP para un cluster enriquecido en animales expuestos a estrés crónico, junto a fragmentos de video correspondientes.\n¡Eso es todo por ahora! En resumen, DeepOF es una herramienta versátil que puede ayudarte a extraer información significativa de tus datos de comportamiento animal. ¡Esperamos que la encuentres tan útil como nosotros!\n¿Y ahora qué? DeepOF está disponible en GitHub y PyPI. Acá podés encontrar documentación detallada, incluyendo instalación en distintos sistemas operativos y tutoriales. Si te interesa entrar en detalle, podés leer nuestras dos publicaciones! La primera cubre el software en si, mientras que la segunda describe cómo usamos DeepOF para caracterizar un modelo de ratón de estrés crónico, para la cual también hay un blog post!.\n",
  "wordCount" : "648",
  "inLanguage": "es",
  "image":"//localhost:1313/deepof_cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lucas Miranda"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "//localhost:1313/es/software/deepof/deepof/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Inicio",
    "logo": {
      "@type": "ImageObject",
      "url": "//localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/es/" accesskey="h" title="Inicio (Alt + H)">Inicio</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="//localhost:1313/en/" title="English"
                            aria-label="English">En</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/es/about/" title="Sobre mí">
                    <span>Sobre mí</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/es/search/" title="Búsqueda">
                    <span>Búsqueda</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/es/refs/" title="Publicaciones">
                    <span>Publicaciones</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/es/software/" title="Software">
                    <span>Software</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      DeepOF
    </h1>
    <div class="post-meta">Lucas Miranda&nbsp;|&nbsp;Traducciones:
<ul class="i18n_list">
    <li>
        <a href="//localhost:1313/en/software/deepof/deepof/">En</a>
    </li>
</ul>

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="//localhost:1313/deepof_cover.png" alt="DeepOF logo with text">
        
</figure>
  <div class="post-content"><h3 id="deepof-es-un-paquete-de-python-para-procesar-datos-de-trackeo-de-animales-obtenidos-con-deeplabcuthttpswwwmackenziemathislaborgdeeplabcuttextdeeplabcute284a220is20an20efficienttypically20502d20020frames-o-sleaphttpssleapai">DeepOF es un paquete de Python para procesar datos de trackeo de animales, obtenidos con <a href="https://www.mackenziemathislab.org/deeplabcut#:~:text=DeepLabCut%E2%84%A2%20is%20an%20efficient,typically%2050%2D200%20frames">DeepLabCut</a> o <a href="https://sleap.ai/">SLEAP</a>.<a hidden class="anchor" aria-hidden="true" href="#deepof-es-un-paquete-de-python-para-procesar-datos-de-trackeo-de-animales-obtenidos-con-deeplabcuthttpswwwmackenziemathislaborgdeeplabcuttextdeeplabcute284a220is20an20efficienttypically20502d20020frames-o-sleaphttpssleapai">#</a></h3>
<p>Las herramientas que tenemos disponibles para cuantificar lo que hacen los animales evolucionaron significativamente en la última década. Desde la observación de animales en la naturaleza, la etología se desplazó significativamente hacia pruebas más simples y controladas en el laboratorio, generalmente midiendo respuestas sencillas a ciertos estímulos.</p>
<p>Avances recientes en visión por computadora y aprendizaje automático permitieron a los investigadores rastrear en detalle el movimiento de animales tanto en el laboratorio como en la naturaleza, sin la necesidad de etiquetas físicas. Típicamente, estos programas se basan en <em>transfer learning</em> (aprendizaje por transferencia) a partir de redes neuronales preentrenadas en grandes conjuntos de datos de imágenes, que primero extraen representaciones de los fotogramas de video. Al etiquetar relativamente pocos fotogramas con partes del cuerpo de interés (unos 200 suelen bastar), las redes pueden luego ajustarse para rastrear estas partes del cuerpo en todos los videos a disposición. Abajo podés ver el flujo de trabajo general del <a href="https://www.nature.com/articles/s41593-018-0209-y">artículo original de DeepLabCut</a>. Modelos más modernos pueden rastrear partes del cuerpo de interés <a href="https://arxiv.org/abs/2203.07436">incluso sin etiquetado previo</a>, aunque siguen siendo menos precisas que estos métodos supervisados.</p>
<p><img loading="lazy" src="../deeplabcut.png" alt="Supervised pipeline in DeepOF"  />
</p>
<p>De esta forma, transformando el video crudo en series temporales de partes del cuerpo rastreadas, estos programas (incluyendo los mencionados <a href="https://www.mackenziemathislab.org/deeplabcut#:~:text=DeepLabCut%E2%84%A2%20is%20an%20efficient,typically%2050%2D200%20frames">DeepLabCut</a> y <a href="https://sleap.ai/">SLEAP</a>) allanaron el camino para herramientas de análisis que pueden etiquetar y caracterizar automáticamente el comportamiento de muchas maneras innovadoras.</p>
<p>DeepOF es nuestra humilde contribución a este esfuerzo. El programa ofrece tanto funciones de anotación tanto supervisada como no supervisada, que permiten a los investigadores probar hipótesis sobre condiciones experimentales como el estrés, mutaciones genéticas y sexo, de una manera flexible.</p>
<p>En primer lugar, la anotación supervisada incluido usa una serie de reglas y modelos de aprendizaje automático preentrenados para detectar cuándo los animales que se están rastreando muestran alguno de una serie de patrones de comportamiento predefinidos.</p>
<p><img loading="lazy" src="../deepof_supervised.png" alt="Supervised pipeline in DeepOF"  />
</p>
<p>De esta manera, podemos etiquetar tanto comportamientos individuales como sociales con solo unas pocas líneas de código! Veamos un ejemplo básico:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> deepof.data
</span></span><span style="display:flex;"><span>my_deepof_project_raw <span style="color:#f92672">=</span> deepof<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>Project(
</span></span><span style="display:flex;"><span>                project_path<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;tutorial_files&#34;</span>),
</span></span><span style="display:flex;"><span>                video_path<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;tutorial_files/Videos/&#34;</span>),
</span></span><span style="display:flex;"><span>                table_path<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;tutorial_files/Tables/&#34;</span>),
</span></span><span style="display:flex;"><span>                project_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;deepof_example_project&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>supervised_annotation <span style="color:#f92672">=</span> my_deepof_project<span style="color:#f92672">.</span>supervised_annotation()
</span></span></code></pre></div><p>Así de fácil, anotamos todos nuestros videos con un conjunto de modelos preentrenados que pueden detectar comportamientos tales como encogerse, trepar, y distintas interacciones sociales.</p>
<p>Además, como mencionamos arriba, DeepOF también viene con un flujo de trabajo no supervisado, que modelos modelos de agrupamiento profundo para descubrir patrones de comportamiento sin definición previa, que también se puede ejecutar con unos pocos comandos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Continuando desde arriba, creamos un conjunto de coordenadas para agrupar,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># removiendo variación posicional y rotacional que no nos interesa</span>
</span></span><span style="display:flex;"><span>coords <span style="color:#f92672">=</span> my_deepof_project<span style="color:#f92672">.</span>get_coords(center<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Center&#34;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Spine_1&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Luego preprocesamos estas coordenadas para hacerlas compatibles con el clustering</span>
</span></span><span style="display:flex;"><span>preprocessed_coords, global_scaler <span style="color:#f92672">=</span> coords<span style="color:#f92672">.</span>preprocess()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Finalmente, entrenamos un modelo de clustering con estas coordenadas preprocesadas</span>
</span></span><span style="display:flex;"><span>trained_model <span style="color:#f92672">=</span> my_deepof_project<span style="color:#f92672">.</span>deep_unsupervised_embedding(
</span></span><span style="display:flex;"><span>  preprocessed_object<span style="color:#f92672">=</span>preprocessed_coords
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Por último, DeepOF incluye un pipeline de interpretabilidad para explorar qué son estos clusters obtenidos, basándonos tanto en Shapley Additive Explanations (SHAP) como en mapeos directos de clusters a fragmentos de video. Además, independientemente del tipo de análisis que elijas, DeepOF te ofrece un extenso conjunto de herramientas de análisis y visualización post-hoc. A continuación podés ver los resultados de SHAP para un cluster enriquecido en animales expuestos a estrés crónico, junto a fragmentos de video correspondientes.</p>
<p><img loading="lazy" src="../deepof_unsupervised.gif" alt="Unsupervised pipeline in DeepOF"  />
</p>
<p>¡Eso es todo por ahora! En resumen, DeepOF es una herramienta versátil que puede ayudarte a extraer información significativa de tus datos de comportamiento animal. ¡Esperamos que la encuentres tan útil como nosotros!</p>
<h3 id="y-ahora-qué">¿Y ahora qué?<a hidden class="anchor" aria-hidden="true" href="#y-ahora-qué">#</a></h3>
<p>DeepOF está disponible en <a href="https://github.com/mlfpm/deepof">GitHub</a> y <a href="https://pypi.org/project/deepof/">PyPI</a>. <a href="https://deepof.readthedocs.io/en/latest/">Acá</a> podés encontrar documentación detallada, incluyendo instalación en distintos sistemas operativos y tutoriales. Si te interesa entrar en detalle, podés leer nuestras dos publicaciones! La primera cubre el <a href="https://joss.theoj.org/papers/10.21105/joss.05394">software en si</a>, mientras que la segunda describe cómo usamos DeepOF para <a href="https://www.nature.com/articles/s41467-023-40040-3">caracterizar un modelo de ratón de estrés crónico</a>, para la cual también hay un <a href="/es/">blog post</a>!.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="//localhost:1313/es/tags/software/">Software</a></li>
      <li><a href="//localhost:1313/es/tags/deepof/">DeepOF</a></li>
      <li><a href="//localhost:1313/es/tags/deeplabcut/">DeepLabCut</a></li>
      <li><a href="//localhost:1313/es/tags/sleap/">SLEAP</a></li>
      <li><a href="//localhost:1313/es/tags/roedores/">Roedores</a></li>
      <li><a href="//localhost:1313/es/tags/series-temporales/">Series Temporales</a></li>
      <li><a href="//localhost:1313/es/tags/postprocesado/">Postprocesado</a></li>
      <li><a href="//localhost:1313/es/tags/videos/">Videos</a></li>
      <li><a href="//localhost:1313/es/tags/python/">Python</a></li>
      <li><a href="//localhost:1313/es/tags/jupyter/">Jupyter</a></li>
      <li><a href="//localhost:1313/es/tags/machine-learning/">Machine Learning</a></li>
      <li><a href="//localhost:1313/es/tags/deep-learning/">Deep Learning</a></li>
      <li><a href="//localhost:1313/es/tags/comportamiento-animal/">Comportamiento Animal</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="//localhost:1313/es/">Inicio</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
